import{b as o,d as c,c as i,e as p,o as v,g as E}from"./app-dDW-M8-3.js";const g=document.querySelector(".back-btn");g&&g.addEventListener("click",()=>{window.history.back()});const r=document.querySelector(".profile-pic"),u=document.getElementById("profile-pic-input");r&&u&&(r.addEventListener("click",()=>{u.click()}),u.addEventListener("change",async e=>{const n=e.target.files[0];if(!n)return;const t=new FileReader;t.onload=function(a){const s=a.target.result.split(",")[1];I(s),B(s)},t.readAsDataURL(n)}));async function B(e){const n=o.currentUser;if(!n){console.error("No user signed in.");return}try{const t=c(i,"users",n.uid);await p(t,{profileImage:e},{merge:!0}),window.location.reload()}catch(t){console.error("Error saving profile image:",t)}}function I(e){r&&(r.style.backgroundImage=`url(data:image/png;base64,${e})`,r.style.backgroundSize="cover",r.style.backgroundPosition="center")}function L(){v(o,async e=>{if(!e)return;const n=c(i,"users",e.uid),t=await E(n);t.exists()&&t.data().profileImage&&I(t.data().profileImage)})}L();const y=document.querySelectorAll(".nav-button"),d=document.querySelector(".edit-btn"),m=document.querySelector(".save-btn"),f=document.querySelectorAll(".account-form input, .account-form select");f.forEach(e=>e.disabled=!0);d.addEventListener("click",()=>{f.forEach(e=>{e.disabled=!1,e.classList.remove("input-locked"),e.classList.add("input-unlocked")}),d.style.display="none",m.style.display="inline-flex"});y.forEach(e=>{e.addEventListener("click",()=>{y.forEach(n=>n.classList.remove("active")),e.classList.add("active")})});m.addEventListener("click",async e=>{e.preventDefault(),await w()&&(f.forEach(t=>{t.disabled=!0,t.classList.remove("input-unlocked"),t.classList.add("input-locked")}),m.style.display="none",d.style.display="inline-flex")});function h(){v(o,async e=>{if(e)try{const n=c(i,"users",e.uid),t=await E(n);if(t.exists()){const{set:a="",email:s="",name:l="",displayName:b="",age:k=""}=t.data();document.getElementById("email").value=s,document.getElementById("username").value=l,document.getElementById("display-name").value=b,document.getElementById("age").value=k,document.getElementById("set").value=a}}catch(n){console.error("Error fetching user document:",n)}})}async function w(){const e=o.currentUser;if(!e)return!1;const n=document.getElementById("age"),t=document.getElementById("ageErrorProfile");t.textContent="",n.classList.remove("input-error");const a=parseInt(n.value);if(isNaN(a)||a<17||a>100)return t.textContent="Age must be between 17 and 100.",n.classList.add("input-error"),!1;try{const s=c(i,"users",e.uid),l={set:document.getElementById("set").value,age:a,email:document.getElementById("email").value,displayName:document.getElementById("display-name").value,name:document.getElementById("username").value};return await p(s,l,{merge:!0}),!0}catch(s){return console.error("Error saving user data:",s),!1}}h();
